{% extends "layout.html" %}

{% block title %}
    Log In
{% endblock %}

{% block main %}
<div class="card-group" >
<span class="card text-white bg-primary mb-3" style="max-width: 18rem; margin: 10px;">
  <div class="card-header">This month</div>
  <div class="card-body">
    <i class="far fa-address-book" style="font-size: xx-large;"></i>
    <span><h5 class="card-title">{{grand_ptotal}}</h5></span>
  </div>
</span>

<span class="card text-white bg-primary mb-3" style="max-width: 18rem; margin: 10px;">
  <div class="card-header">This month</div>
  <div class="card-body">
    <i class="far fa-address-book" style="font-size: xx-large;"></i>
    <span><h5 class="card-title">{{grand_ptotal}}</h5></span>
  </div>
</span>



<span class="card text-white bg-primary mb-3" style="max-width: 18rem; margin: 10px;">
  <div class="card-header">This month</div>
  <div class="card-body">
    <i class="far fa-address-book" style="font-size: xx-large;"></i>
    <span><h5 class="card-title">{{grand_ptotal}}</h5></span>
  </div>
</span>

</div>


<div class="card text-white bg-secondary text-center col container" style="max-width: 80vw" >
  <div class="card-header">Header</div>
    <div class="card-body container">
      <form action="/personal" method="post">
          <div class="form-group">
              <input autocomplete="off" autofocus class="form-control" name="commodity" placeholder="commodity" type="text">
          </div>
          <div class="form-group">
              <input class="form-control" name="amount" placeholder="amount" type="number">
          </div>
          <button class="btn btn-primary" type="pspend">Spend!</button>
      </form>
    </div>
  </div>
</div>  


<h1 class="display-1">This Month</h1>
<!-- main+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<!-- main+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<!-- main+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
<main class="container p-5">

<table class="table table-striped table-hover table-primary">
    <thead class="thead-dark">
        <tr>
          <th scope="col">Pid</th>
          <th scope="col">Commodity</th>
          <th scope="col">Amount</th>
          <th scope="col">Time</th>
          <th scope="col">Actions</th>
        </tr>
      </thead>
    <tbody>
        {% for pspending in pspendings: %}
        <tr>
            <th scope="row">{{pspending["pid"]}}</th>
            <td>{{pspending["commodity"]}}</td>
            <td>{{pspending["amount"]}}</td>
            <td>{{pspending["time"]}}</td> 
            <td>
                <a href="/personal/delete/{{pspending['pid']}}" class="btn btn-dark btn-large ">Delete</a>
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" data-whatever="{{pspending['commodity']}}" data-link="/personal/update/{{pspending['pid']}}">update</button>
            </td>
        </tr>
        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">New message</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <form class="formaction" method="POST">
                    <div class="form-group">
                      <label for="recipient-name"  class="col-form-label">commodity:</label>
                      <input type="text" class="form-control" name="update_commodity" id="recipient-name">
                    </div>
                    <div class="form-group">
                      <label for="message-text" class="col-form-label">amount:</label>
                      <input class="form-control" type="number" name="update_amount" id="message-text"></input>
                    </div>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  <button type="submit"  class="btn btn-primary ">Update</button>
                </div>
            </form>
              </div>
            </div>
        </div>
        {% endfor %}
        <tr class="table-info">
            <th scope="row">CASH Remaining</th>
            <td colspan="3"></td>
            <td>{{cash}}</td>
        </tr>
    </tbody>
    <tfoot>
        
        <tr class="table-primary">
            <th scope="row">NET-WORTH$$</th>
            <td colspan="3"></td>
            <td>{{grand_ptotal}}</td>
        </tr>
    </tfoot>
</table>










    <table class="table table-striped table-hover table-primary">
      <thead class="thead-dark">
          <tr>
            <th scope="col">Pid</th>
            <th scope="col">Commodity</th>
            <th scope="col">Amount</th>
            <th scope="col">Time</th>
            <th scope="col">Actions</th>
          </tr>
        </thead>
      <tbody>
        {% for hpspending in hpspendings: %}
        <tr>
            <th scope="row">{{hpspending["payid"]}}</th>
            <td>{{hpspending["paymentpurpose"]}}</td>
            <td>{{hpspending["amount"]}}</td>
            <td>{{hpspending["datestamp"]}}</td> 
            <td>{{hpspending["category"]}}</td> 
            <td>{{hpgrand_ptotal}}</td> 
        </tr>
        {% endfor %}
        </tbody>
<script>
    $('#exampleModal').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget) // Button that triggered the modal
        var recipient = button.data('whatever')
        var link = button.data('link')
        // Extract info from data-* attributes
        // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
        // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
        var modal = $(this)
        modal.find('.modal-title').text('New message to ' + recipient)
        modal.find('.modal-body input').val(recipient)
        modal.find('.formaction').attr("action",link)
      }) 
</script> 
</main>        
{% endblock %}

